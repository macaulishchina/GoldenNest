# ç§»åŠ¨ç«¯è¯­éŸ³åŠŸèƒ½éƒ¨ç½²æŒ‡å—

## ä¸ºä»€ä¹ˆéœ€è¦ HTTPSï¼Ÿ

æµè§ˆå™¨çš„ `navigator.mediaDevices`ï¼ˆå½•éŸ³ APIï¼‰**åªåœ¨å®‰å…¨ä¸Šä¸‹æ–‡ä¸­å¯ç”¨**ï¼š

| è®¿é—®æ–¹å¼ | å½•éŸ³å¯ç”¨ | è¯´æ˜ |
|----------|:--------:|------|
| `http://localhost` | âœ… | localhost æ˜¯ç‰¹ä¾‹ |
| `https://ä»»æ„åœ°å€` | âœ… | HTTPS = å®‰å…¨ä¸Šä¸‹æ–‡ |
| `http://192.168.x.x` | âŒ | **æ‰‹æœºå±€åŸŸç½‘è®¿é—®ï¼Œå½•éŸ³ä¸å¯ç”¨** |

æ‰€ä»¥è¦è®©æ‰‹æœºç”¨è¯­éŸ³åŠŸèƒ½ï¼Œ**å¿…é¡» HTTPS**ã€‚

---

## éƒ¨ç½²æµç¨‹ï¼ˆ3 æ­¥æå®šï¼‰

### ç¬¬ 1 æ­¥ï¼šç”Ÿæˆ SSL è¯ä¹¦

åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š

```bash
# Linux / Mac / Git Bash
bash generate_ssl.sh 192.168.1.100    # â† æ”¹æˆä½ çš„å±€åŸŸç½‘ IP

# Windows CMD
generate_ssl.bat 192.168.1.100        # â† æ”¹æˆä½ çš„å±€åŸŸç½‘ IP
```

> ğŸ’¡ å¦‚ä½•æŸ¥çœ‹ä½ çš„ IPï¼Ÿ
> - Windows: `ipconfig` â†’ æ‰¾ IPv4 åœ°å€
> - Mac/Linux: `ifconfig` æˆ– `ip addr`

æ‰§è¡Œåä¼šåœ¨ `ssl/` ç›®å½•ç”Ÿæˆï¼š
```
ssl/
â”œâ”€â”€ cert.pem     â† æœåŠ¡å™¨è¯ä¹¦
â”œâ”€â”€ key.pem      â† æœåŠ¡å™¨ç§é’¥
â”œâ”€â”€ ca.pem       â† CA æ ¹è¯ä¹¦ï¼ˆéœ€å¯¼å…¥æ‰‹æœºï¼‰
â””â”€â”€ ca.key       â† CA ç§é’¥
```

### ç¬¬ 2 æ­¥ï¼šæ‰‹æœºå®‰è£… CA è¯ä¹¦ï¼ˆæ¶ˆé™¤å®‰å…¨è­¦å‘Šï¼‰

**ä¸å®‰è£…ä¹Ÿèƒ½ç”¨**ï¼Œä½†æ¯æ¬¡è®¿é—®éƒ½å¼¹"ä¸å®‰å…¨"è­¦å‘Šã€‚å®‰è£…å**å®Œå…¨ä¸å¼¹**ã€‚

#### ä¼ é€è¯ä¹¦åˆ°æ‰‹æœº

æœ€ç®€å•çš„æ–¹å¼â€”â€”ä¸´æ—¶ HTTP æœåŠ¡å™¨ï¼š

```bash
cd ssl
python -m http.server 9999
# æ‰‹æœºæµè§ˆå™¨æ‰“å¼€ http://192.168.1.100:9999/ca.pem ä¸‹è½½
```

ä¹Ÿå¯ä»¥é€šè¿‡å¾®ä¿¡/é‚®ä»¶/AirDrop ç­‰ä¼ é€ `ssl/ca.pem` æ–‡ä»¶ã€‚

#### iPhone å®‰è£…

1. æ‰“å¼€ä¸‹è½½çš„ `ca.pem` â†’ å¼¹å‡º"å·²ä¸‹è½½æè¿°æ–‡ä»¶"æç¤º
2. **è®¾ç½®** â†’ **å·²ä¸‹è½½æè¿°æ–‡ä»¶** â†’ **å®‰è£…** â†’ è¾“å…¥é”å±å¯†ç  â†’ å®‰è£…
3. **è®¾ç½®** â†’ **é€šç”¨** â†’ **å…³äºæœ¬æœº** â†’ **è¯ä¹¦ä¿¡ä»»è®¾ç½®** â†’ æ‰¾åˆ° `GoldenNest Local CA` â†’ **å¼€å¯ä¿¡ä»»**

#### Android å®‰è£…

1. **è®¾ç½®** â†’ **å®‰å…¨** â†’ **åŠ å¯†ä¸å‡­æ®** â†’ **å®‰è£…è¯ä¹¦** â†’ **CA è¯ä¹¦**
2. é€‰æ‹©ä¸‹è½½çš„ `ca.pem` â†’ ç¡®è®¤å®‰è£…
3. éƒ¨åˆ†æœºå‹è·¯å¾„ï¼šè®¾ç½® â†’ æ›´å¤šè®¾ç½® â†’ ç³»ç»Ÿå®‰å…¨ â†’ ä»å­˜å‚¨è®¾å¤‡å®‰è£…

> âš ï¸ ä¸åŒ Android å“ç‰Œè·¯å¾„ç•¥æœ‰ä¸åŒï¼Œæœç´¢è®¾ç½®ä¸­çš„"è¯ä¹¦"å³å¯æ‰¾åˆ°ã€‚

### ç¬¬ 3 æ­¥ï¼šå¯åŠ¨æœåŠ¡

```bash
# Docker éƒ¨ç½²ï¼ˆæ¨èï¼‰
docker-compose up -d --build

# è®¿é—®åœ°å€
# HTTP:  http://192.168.1.100:8088   â† è‡ªåŠ¨è·³è½¬åˆ° HTTPS
# HTTPS: https://192.168.1.100:8443  â† æ‰‹æœºè¯­éŸ³å¯ç”¨ï¼
```

å¦‚æœè¦è‡ªå®šä¹‰ç«¯å£ï¼š

```bash
# .env æ–‡ä»¶
HTTP_PORT=80
HTTPS_PORT=443
```

---

## å¼€å‘ç¯å¢ƒï¼ˆç”µè„‘ä¸Š localhostï¼‰

å¼€å‘ç¯å¢ƒ**ä¸éœ€è¦ HTTPS**ï¼Œå› ä¸º `localhost` å¤©ç„¶æ˜¯å®‰å…¨ä¸Šä¸‹æ–‡ï¼š

```bash
# æ­£å¸¸å¯åŠ¨å³å¯
cd frontend && npm run dev     # http://localhost:5173
cd backend && python -m uvicorn app.main:app --reload
```

> ğŸ“Œ åœ¨ç”µè„‘ä¸Šç”¨ `http://localhost:5173` è®¿é—®ï¼Œå½•éŸ³åŠŸèƒ½æ­£å¸¸å¯ç”¨ã€‚
> åªæœ‰æ‰‹æœºé€šè¿‡å±€åŸŸç½‘ IP è®¿é—®æ—¶æ‰éœ€è¦ HTTPSã€‚

---

## æ¶æ„è¯´æ˜

```
æ‰‹æœºæµè§ˆå™¨
   â”‚
   â”‚ https://192.168.1.100:8443
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Nginx (HTTPS:443)  â”‚  â† SSL ç»ˆæ­¢
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ é™æ€æ–‡ä»¶     â”‚   â”‚  /  â†’ Vue SPA
â”‚   â”‚ (Vue dist)   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ åå‘ä»£ç†     â”‚   â”‚  /api/ â†’ FastAPI
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚ http://backend:8000
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FastAPI (HTTP)     â”‚  â† å†…éƒ¨é€šä¿¡ä¸éœ€è¦ SSL
â”‚   â””â”€â”€ è¯­éŸ³è¯†åˆ«       â”‚
â”‚       â””â”€â”€ DashScope  â”‚  â†’ qwen3-omni-flash
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸ä½¿ç”¨ Docker æ—¶çš„éƒ¨ç½²æ–¹å¼

å¦‚æœä¸ç”¨ Dockerï¼Œç›´æ¥ç”¨ Nginxï¼š

```bash
# 1. ç”Ÿæˆè¯ä¹¦
bash generate_ssl.sh 192.168.1.100

# 2. æ„å»ºå‰ç«¯
cd frontend && npm run build

# 3. é…ç½® Nginx
# å°† frontend/nginx.ssl.conf å¤åˆ¶åˆ° Nginx é…ç½®ç›®å½•
# ä¿®æ”¹ ssl_certificate å’Œ ssl_certificate_key è·¯å¾„æŒ‡å‘ ssl/ ç›®å½•
# ä¿®æ”¹ proxy_pass æŒ‡å‘å®é™…çš„åç«¯åœ°å€

# 4. å¯åŠ¨åç«¯
cd backend && python -m uvicorn app.main:app --host 0.0.0.0 --port 8000

# 5. å¯åŠ¨ Nginx
nginx -s reload
```

---

## å¸¸è§é—®é¢˜

### Q: æ‰‹æœºè¿˜æ˜¯å¼¹å®‰å…¨è­¦å‘Šï¼Ÿ
- ç¡®è®¤å·²å®‰è£… **CA æ ¹è¯ä¹¦**ï¼ˆ`ca.pem`ï¼‰ï¼Œä¸æ˜¯æœåŠ¡å™¨è¯ä¹¦ï¼ˆ`cert.pem`ï¼‰
- iPhone éœ€è¦é¢å¤–ä¸€æ­¥ï¼š**è¯ä¹¦ä¿¡ä»»è®¾ç½®** â†’ å¼€å¯ä¿¡ä»»
- å¦‚æœæ¢äº† IPï¼Œéœ€è¦é‡æ–°ç”Ÿæˆè¯ä¹¦

### Q: å½•éŸ³æŒ‰é’®ç°äº†/ç‚¹å‡»æ— ååº”ï¼Ÿ
- æ£€æŸ¥æ˜¯å¦é€šè¿‡ HTTPS è®¿é—®
- Chrome åœ°å€æ åº”æ˜¾ç¤º ğŸ”’ å›¾æ ‡
- å¦‚æœæ˜¾ç¤º "ä¸å®‰å…¨"ï¼Œè¯´æ˜è¯ä¹¦æœªä¿¡ä»»æˆ–ä¸æ˜¯ HTTPS

### Q: è¯­éŸ³è½¬å½•è¿”å›é”™è¯¯ï¼Ÿ
- åå° AI_MODEL éœ€åˆ‡æ¢åˆ°æ”¯æŒéŸ³é¢‘è¾“å…¥çš„æ¨¡å‹
- æ¨èï¼š`qwen3-omni-flash`ã€`qwen-omni-turbo`
- âŒ ä¸èƒ½ç”¨ï¼š`qwen-max`ã€`qwen-plus`ï¼ˆçº¯æ–‡æœ¬æ¨¡å‹ï¼‰ã€`qwen3-tts-*`ï¼ˆTTS æ–¹å‘ç›¸åï¼‰

### Q: æ²¡æœ‰ openssl å‘½ä»¤ï¼Ÿ
- **Windows**: å®‰è£… Git åï¼Œåœ¨ Git Bash ä¸­è¿è¡Œ `bash generate_ssl.sh`
- **Mac**: è‡ªå¸¦ openssl
- **Linux**: `apt install openssl` æˆ– `yum install openssl`

### Q: æ¢äº†æ–° IP æ€ä¹ˆåŠï¼Ÿ
é‡æ–°è¿è¡Œ `generate_ssl.sh æ–°IP`ï¼Œæ‰‹æœºé‡æ–°å®‰è£… `ca.pem` å³å¯ã€‚
